\XeTeXinputencoding "GB2312"
\chapter{双信息保存方法（Dual information preserving method）方法}
界面作为最为常见的物理现象之一，广泛的存在于
力学、化学、生物工程、材料科学和计算机图形学等多个学科领域。
界面的准确模拟对于多相流动、晶体生长、火焰的发展和传播等等很多方面的研究都有重要意义。
\section{不同的界面类型和界面方法}
  界面方法最早可以追溯到1958年的洛斯・阿拉莫斯国家实验室发展的 Particle-In-Cell(PIC)方法\cite{evans1957particle,harlow1957hydrodynamic} 。关于不同的界面方法第一章 \ref{cap:interface} 节中有较详细介绍。本章中，我们将从方程的角度来分析界面问题。

忽略力学模型，界面的运动可以抽象为求解对流方程
\begin{equation} \label{eq:interface_mark}
  \frac{\partial z}{\partial t} +\bm{V} \cdot \nabla z =0
  \end{equation}
  其中$\bm{V}$为速度场，$z$为区分界面两侧物质相关的量。
下面分别对不同的界面类型进行分析。
\subsection{传统界面}
方程 (\ref{eq:interface_mark}) 尽管是最简单的对流方程，然而如果我们关注于界面运动时，想要实时的得到几何面（线）是异常困难的。以一维图 \ref{fig:illu_1dinterface} 为例，如果直接对方程 （\ref{eq:interface_mark}) 进行求解，例如采用差分方法，随着间断被耗散，界面将无法识别。

因此，绝大多数界面方法其实并不直接求解方程  (\ref{eq:interface_mark}) 本身，而是采用一种追踪的视角，图 \ref{fig:illu_1dinterface_method} 给出不同界面方法的一维示意图。其中锋面追踪方法直接追踪界面； MAC方法在界面一侧添加标记点；而VOF方法在每一个网格引入一个体积分数函数，将界面的运动转化为体积分数的变化。只有level set方法求解方程 (\ref{eq:interface_mark})，但是也并不直接求解间断函数$z$本身，而是以到界面距离为函数构造一个新的光滑的level set函数$\phi$，求解
\begin{equation*}
\frac{\partial \phi}{\partial t}+\bm{V}\cdot \nabla \phi=0
\end{equation*}

如图 \ref{fig:illu_1dinterface_method}.d 所示，level set方法将$\phi=0$的位置识别为界面位置。 
\begin{figure}
  \centering
  \begin{tikzpicture}
	\node (A1) [circle,draw,inner sep=0.5mm]  at (0.5,0){}; 
	\node (A2) [circle,draw,inner sep=0.5mm]  at (1,0){}; 
	\node (A3) [circle,draw,inner sep=0.5mm]  at (1.5,0){}; 
	\node (A4) [circle,draw,inner sep=0.5mm]  at (2,0){}; 
	\node (A5) [circle,draw,inner sep=0.5mm]  at (2.5,0){}; 
	\node (A6) [circle,draw,inner sep=0.5mm]  at (3,0){}; 
	\node (A7) [circle,draw,inner sep=0.5mm]  at (3.5,0){}; 
	\node (A8) [circle,draw,inner sep=0.5mm]  at (4.,0){}; 
	\node (A9) [circle,draw,inner sep=0.5mm]  at (4.5,0){}; 
	\node (A10) [circle,draw,inner sep=0.5mm]  at (5.,0){}; 
		\coordinate(B1) at (0.5,0.5);
		\coordinate(B2) at (2.5,0.5);
		\draw  [line width=1pt, color=black!80] (B1) -- (B2);
		\draw   [line width=1pt, color=black!80] (B2)-- (2.5,2.5);
		\draw   [line width=1.3pt, color=black!60,dashed] (2.5,0)-- (2.5,3.5);
\draw    [line width=1.2pt, color=black!80] (2.5,2.5)--(4.5,2.5);
\draw  [->,line width=1pt,color=black!60](0,0)--(5.8,0) node [anchor=north] {$x$};
 \draw [->,line width=1pt,color=black!60](0,0) -- (0,4) node [anchor=east] {$z$};
 \node at (1.5,1.5){$z=z_1$};
 \node at (3.5,1.5){$z=z_2$};
 \node at (2.9,3.){{\scriptsize 界面}};
\end{tikzpicture}
\caption{一维界面示意图}
\label{fig:illu_1dinterface}
\end{figure}


\begin{figure}
  \centering
 \begin{tikzpicture} %front tracking
	\node (A1) [circle,draw,inner sep=0.3mm]  at (0.3,0){}; 
	\node (A11) [circle,draw,inner sep=0.3mm] at (0.9,0){}; 
	\node (A4) [circle,draw,inner sep=0.3mm]  at (1.5,0){}; 
	\node (A6) [circle,draw,inner sep=0.3mm]  at (2.1,0){}; 
	\node (A8) [circle,draw,inner sep=0.3mm]  at (2.7,0){}; 
	\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0.0){}; 
	\node (A2) [circle,draw,inner sep=0.3mm]  at (3.9,0.0){}; 

	\node (C1)  at (0.3,3.){}; 
	\node (C11) at (0.9,3.){}; 
	\node (C4)  at (1.5,3.){}; 
	\node (C6)  at (2.1,3.){}; 
	\node (C8)  at (2.7,3.){}; 
	\node (C10) at (3.3,3.){}; 
	\node (C2) at (3.9,3.){}; 

		\draw  [line width=1pt, color=black!20] (A1) -- (C1);
		\draw  [line width=1pt, color=black!20] (A4) -- (C4);
		\draw  [line width=1pt, color=black!20] (A6) -- (C6);
		\draw  [line width=1pt, color=black!20] (A8) -- (C8);
		\draw  [line width=1pt, color=black!20] (A10) -- (C10);
		\draw  [line width=1pt, color=black!20] (A11) -- (C11);
		\draw  [line width=1pt, color=black!20] (A2) -- (C2);

\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0){}; 
		\coordinate(B1) at (0.3,0.5);
		\coordinate(B2) at (2.5,0.5);
		%\draw  [line width=1pt, color=black!80] (B1) -- (B2);
%		\draw   [line width=1pt, color=black!80] (B2)-- (2.5,2.5);
		\draw   [line width=1.3pt, color=black!60,dashed] (2.4,0)-- (2.4,2.9);

		\draw[line width=0.8pt, color=blue!60!black!60]  (2.4+0.1,1.5)-- (2.4-0.08,1.5+0.1); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.4-0.08,1.5+0.1)--(2.4-0.08,1.5-0.1); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.4-0.08,1.5-0.1)--  (2.4+0.1,1.5);


%\draw    [line width=1.2pt, color=black!80] (2.5,2.5)--(4.5,2.5);
\draw  [->,line width=1pt,color=black!60](0,0)--(4.2,0) node [anchor=north] {$x$};
% \draw [->,line width=1pt,color=black!60](0,0) -- (0,3) node [anchor=east] {$z$};
 \node at (2.8,2.5){{\scriptsize 界面}};
 \node at (2.,-0.5){\scriptsize{(a) 锋面追踪方法}};
\end{tikzpicture}
  \begin{tikzpicture} %MAC
	\node (A1) [circle,draw,inner sep=0.3mm]  at (0.3,0){}; 
	\node (A11) [circle,draw,inner sep=0.3mm] at (0.9,0){}; 
	\node (A4) [circle,draw,inner sep=0.3mm]  at (1.5,0){}; 
	\node (A6) [circle,draw,inner sep=0.3mm]  at (2.1,0){}; 
	\node (A8) [circle,draw,inner sep=0.3mm]  at (2.7,0){}; 
	\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0.0){}; 
	\node (A2) [circle,draw,inner sep=0.3mm]  at (3.9,0.0){}; 

	\node (C1)  at (0.3,3.){}; 
	\node (C11) at (0.9,3.){}; 
	\node (C4)  at (1.5,3.){}; 
	\node (C6)  at (2.1,3.){}; 
	\node (C8)  at (2.7,3.){}; 
	\node (C10) at (3.3,3.){}; 
	\node (C2) at (3.9,3.){}; 

		\draw  [line width=1pt, color=black!20] (A1) -- (C1);
		\draw  [line width=1pt, color=black!20] (A4) -- (C4);
		\draw  [line width=1pt, color=black!20] (A6) -- (C6);
		\draw  [line width=1pt, color=black!20] (A8) -- (C8);
		\draw  [line width=1pt, color=black!20] (A10) -- (C10);
		\draw  [line width=1pt, color=black!20] (A11) -- (C11);
		\draw  [line width=1pt, color=black!20] (A2) -- (C2);

\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0){}; 
		\coordinate(B1) at (0.3,0.5);
		\coordinate(B2) at (2.5,0.5);
		%\draw  [line width=1pt, color=black!80] (B1) -- (B2);
%		\draw   [line width=1pt, color=black!80] (B2)-- (2.5,2.5);
		\draw   [line width=1.3pt, color=black!60,dashed] (2.1,0)-- (2.1,2.9);

		\draw[line width=0.8pt, color=blue!60!black!60]  (2.2+0.05,1.5)-- (2.2-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.2-0.04,1.5+0.05)--(2.2-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.2-0.04,1.5-0.05)--  (2.2+0.05,1.5);


		\draw[line width=0.8pt, color=blue!60!black!60]  (2.6+0.05,1.5)-- (2.6-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.6-0.04,1.5+0.05)--(2.6-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.6-0.04,1.5-0.05)--  (2.6+0.05,1.5);

		\draw[line width=0.8pt, color=blue!60!black!60]  (2.8+0.05,1.5)-- (2.8-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.8-0.04,1.5+0.05)--(2.8-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.8-0.04,1.5-0.05)--  (2.8+0.05,1.5);

		\draw[line width=0.8pt, color=blue!60!black!60]  (2.9+0.05,1.5)-- (2.9-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.9-0.04,1.5+0.05)--(2.9-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (2.9-0.04,1.5-0.05)--  (2.9+0.05,1.5);


		\draw[line width=0.8pt, color=blue!60!black!60]  (3.2+0.05,1.5)-- (3.2-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (3.2-0.04,1.5+0.05)--(3.2-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (3.2-0.04,1.5-0.05)--  (3.2+0.05,1.5);

		\draw[line width=0.8pt, color=blue!60!black!60]  (3.7+0.05,1.5)-- (3.7-0.04,1.5+0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (3.7-0.04,1.5+0.05)--(3.7-0.04,1.5-0.05); 
		\draw[line width=0.8pt, color=blue!60!black!60]  (3.7-0.04,1.5-0.05)--  (3.7+0.05,1.5);

%\draw    [line width=1.2pt, color=black!80] (2.5,2.5)--(4.5,2.5);
\draw  [->,line width=1pt,color=black!60](0,0)--(4.2,0) node [anchor=north] {$x$};
% \draw [->,line width=1pt,color=black!60](0,0) -- (0,3) node [anchor=east] {$z$};
 \node at (2.5,2.5){{\scriptsize 界面}};
 \node at (2.,-0.5){\scriptsize{(b) MAC粒子方法}};
\end{tikzpicture}

  \begin{tikzpicture} %VOF
	\node (A1) [circle,draw,inner sep=0.3mm]  at (0.3,0){}; 
	\node (A11) [circle,draw,inner sep=0.3mm] at (0.9,0){}; 
	\node (A4) [circle,draw,inner sep=0.3mm]  at (1.5,0){}; 
	\node (A6) [circle,draw,inner sep=0.3mm]  at (2.1,0){}; 
	\node (A8) [circle,draw,inner sep=0.3mm]  at (2.7,0){}; 
	\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0.0){}; 
	\node (A2) [circle,draw,inner sep=0.3mm]  at (3.9,0.0){}; 

	\node (C1)  at (0.3,3.){}; 
	\node (C11) at (0.9,3.){}; 
	\node (C4)  at (1.5,3.){}; 
	\node (C6)  at (2.1,3.){}; 
	\node (C8)  at (2.7,3.){}; 
	\node (C10) at (3.3,3.){}; 
	\node (C2) at (3.9,3.){}; 

		\draw  [line width=1pt, color=black!20] (A1) -- (C1);
		\draw  [line width=1pt, color=black!20] (A4) -- (C4);
		\draw  [line width=1pt, color=black!20] (A6) -- (C6);
		\draw  [line width=1pt, color=black!20] (A8) -- (C8);
		\draw  [line width=1pt, color=black!20] (A10) -- (C10);
		\draw  [line width=1pt, color=black!20] (A11) -- (C11);
		\draw  [line width=1pt, color=black!20] (A2) -- (C2);

\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0){}; 
		\coordinate(B1) at (0.3,0.5);
		\coordinate(B2) at (2.5,0.5);
		%\draw  [line width=1pt, color=black!80] (B1) -- (B2);
%		\draw   [line width=1pt, color=black!80] (B2)-- (2.5,2.5);
		\draw   [line width=1.3pt, color=black!60,dashed] (2.4,0)-- (2.4,2.9);
		\node at (0.6,1.5){\scriptsize 0};
		\node at (1.2,1.5){\scriptsize 0};
		\node at (1.8,1.5){\scriptsize 0};
		\node at (2.5,1.5){\scriptsize 0.5};
		\node at (3.0,1.5){\scriptsize 1};
		\node at (3.6,1.5){\scriptsize 1};
%\draw    [line width=1.2pt, color=black!80] (2.5,2.5)--(4.5,2.5);
\draw  [->,line width=1pt,color=black!60](0,0)--(4.2,0) node [anchor=north] {$x$};
% \draw [->,line width=1pt,color=black!60](0,0) -- (0,3) node [anchor=east] {$z$};
 \node at (2.8,2.5){{\scriptsize 界面}};
 \node at (2.,-0.5){\scriptsize{(c) VOF方法}};
\end{tikzpicture}
  \begin{tikzpicture} %level set
	\node (A1) [circle,draw,inner sep=0.3mm]  at (0.3,0){}; 
	\node (A11) [circle,draw,inner sep=0.3mm] at (0.9,0){}; 
	\node (A4) [circle,draw,inner sep=0.3mm]  at (1.5,0){}; 
	\node (A6) [circle,draw,inner sep=0.3mm]  at (2.1,0){}; 
	\node (A8) [circle,draw,inner sep=0.3mm]  at (2.7,0){}; 
	\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0.0){}; 
	\node (A2) [circle,draw,inner sep=0.3mm]  at (3.9,0.0){}; 

	\node (C1)  at (0.3,3.){}; 
	\node (C11) at (0.9,3.){}; 
	\node (C4)  at (1.5,3.){}; 
	\node (C6)  at (2.1,3.){}; 
	\node (C8)  at (2.7,3.){}; 
	\node (C10) at (3.3,3.){}; 
	\node (C2) at (3.9,3.){}; 

%		\draw  [line width=1pt, color=black!20] (A1) -- (C1);
%		\draw  [line width=1pt, color=black!20] (A4) -- (C4);
%		\draw  [line width=1pt, color=black!20] (A6) -- (C6);
%		\draw  [line width=1pt, color=black!20] (A8) -- (C8);
%		\draw  [line width=1pt, color=black!20] (A10) -- (C10);
%		\draw  [line width=1pt, color=black!20] (A11) -- (C11);
%		\draw  [line width=1pt, color=black!20] (A2) -- (C2);

\node (A10) [circle,draw,inner sep=0.3mm]  at (3.3,0){}; 
		\coordinate(B1) at (0.3,0.5);
		\coordinate(B2) at (2.5,0.5);
		%\draw  [line width=1pt, color=black!80] (B1) -- (B2);
%		\draw   [line width=1pt, color=black!80] (B2)-- (2.5,2.5);
		\draw   [line width=1.3pt, color=black!60,dashed] (2.1,0)-- (2.1,2.9);
		\draw   [line width=1.3pt, color=black!60] (2.1,1.5)-- (3.9,2.7);
		\draw   [line width=1.0pt, color=black!60] (2.1,1.5)-- (0.3,0.3);
%\draw    [line width=1.2pt, color=black!80] (2.5,2.5)--(4.5,2.5);
\draw  [->,line width=1pt,color=black!60](0,0)--(4.2,0) node [anchor=north] {$x$};
\draw  [line width=0.5pt,color=black!60,dashed](0,1.5) --(4.2,1.5);
\draw  [line width=0.5pt,color=black!60,dashed](0,1.5) --(4.2,1.5);

 \draw [->,line width=1pt,color=black!60](0,0) -- (0,3) node [anchor=east] {$\phi$};
 \node at (2.8,2.5){{\scriptsize 界面}};
 \node at (-0.2,1.5) {\scriptsize $0$};
 \node at (2.,-0.5){\scriptsize{(d) level set方法}};
\end{tikzpicture}

\caption{一维界面示意图}
\label{fig:illu_1dinterface_method}
\end{figure}


从图中，我们可以看出，这些界面方法明显分成两类，一类全计算域计算的，如VOF和level set方法，另外一类只在计算域内部分区域进行计算，如锋面追踪、MAC方法等。两类方法各有优势，第一类方法更适合处理光滑的几何形状，并且易于处理由于由于流体压缩性导致的膨胀过程；第二类方法在处理含有锋利夹角的形状时以及界面破碎问题时有优势。

\section{多相界面和耗散界面}
由于上述这些界面方法都不是求解某一真实的物理量，如$\gamma, \rho$，而只是从拓扑角度计算界面的运动。这一问题导致传统界面类方法无法直接用来求解如图  所示的多相界面和具有界面厚度的耗散界面。

%\begin{
