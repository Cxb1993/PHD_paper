\chapter{低耗散激波捕捉格式}\label{chap:mscrweno}
由于具有激波捕捉能力和近谱方法的分辨率，加权紧致格式是模拟超声速流动很好的方法。然而，由于紧致格式天然的隐式特点，精度在局部点的降低将污染整个流场。紧致重构WENO格式（CRWENO格式）是近年来提出的一种有效的高精度激波捕捉格式。本章中将证明，CRWENO格式对于激波附近的点只有二阶精度。本章中提出了一种多步加权方法来构造新的CRWENO格式以提高在激波附近的精度。与通常的一步加权方法不同的是，多步加权方法先构造出两个四阶格式。最终的五阶格式则是通过这两个四阶格式加权得到。通过这种方式，CRWENO在激波附近的精度被提升到了三阶，并利用修正波数法分析了新格式的耗散及色散特性。大量的数值结果表明，相对于原格式，无论是在光滑区域还是间断区域，所提出的多步加权方法有更低的耗散和更高的分辨率。进一步，本章中发展了一种无问题相关参数的混合格式开关函数。基于新的开关函数，我们在五阶WENO的五点模板上构建出了一种七阶紧致-CRWENO混合格式。数值结果验证了所构造的函数及格式的高精度及鲁棒性。
\section{间断附近点的精度分析}\label{accuracy analysis}
与五阶WENO格式相比，CRWENO格式有更好的分辨率和耗散特性\cite{ghosh2012compact}。然而，下面将证明，CRWENO格式在间断附近的精度并不理想。由于紧致格式的隐式特性，在局部点精度的降低将会影响到全局的精度。这是CRWENO格式及其他加权紧致格式的一个主要缺点。对于复杂流动，如激波边界层相互作用和有shocklet的超声速湍流来说，我们所感兴趣的流动总是在激波附近。
\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.9\textwidth]{images/pointsketch-eps-converted-to}
\caption{两个间断之间分布六个点}
\label{chapter2fig:sketch}
\end{center}
\end{figure}

对于五阶CRWENO格式，总共有五个点用于计算数值通量。这里，作为一个例子，我们分析在两个间断之间有六个点的一个模板 (见图 \ref{chapter2fig:sketch})。对于左右边界上的两个点来说(点$0$和$5$)，只有一个三点模板是光滑的，即($x_0,x_1,x_2$)和($x_3,x_4,x_5$)。 对于点0，间断在它的第一个和第二个模板上，因此有$\omega_0\rightarrow0$，$\omega_1\rightarrow0$以及 $\omega_2\rightarrow1$。因此，对于点0，\eqref{chapter1eq:22}变为：
\begin{equation}
\frac{2}{3}\hat{f}_{0+\frac{1}{2}}+\frac{1}{3}\hat{f}_{0+\frac{3}{2}}=\\
\frac{1}{6}f_{0}+\frac{5}{6}f_{1}\label{chapter2eq:12}
\end{equation}
对于点1，间断位于它的第一个模板上，因此有$\omega_0\rightarrow0$, $\omega_1\rightarrow\frac{5}{8}$, $\omega_2\rightarrow\frac{3}{8}$，则：
\begin{equation}
\frac{5}{24}\hat{f}_{1-\frac{1}{2}}+\frac{2}{3}\hat{f}_{1+\frac{1}{2}}+\frac{3}{24}\hat{f}_{1+\frac{3}{2}}=\\
\frac{28}{48}f_{1}+\frac{20}{48}f_{2}\label{chapter2eq:13}
\end{equation}
对于剩下的点做同样的分析，我们可以得到:
\begin{flalign}
\frac{3}{10}\hat{f}_{2-\frac{1}{2}}+\frac{6}{10}\hat{f}_{2+\frac{1}{2}}+\frac{3}{24}\hat{f}_{2+\frac{3}{2}} & =\frac{1}{30}f_{1}+\frac{19}{30}f_{2}+\frac{1}{3}f_{3}\label{chapter2eq:14}\\
\frac{3}{10}\hat{f}_{3-\frac{1}{2}}+\frac{6}{10}\hat{f}_{3+\frac{1}{2}}+\frac{3}{24}\hat{f}_{3+\frac{3}{2}} & =\frac{1}{30}f_{2}+\frac{19}{30}f_{3}+\frac{1}{3}f_{4}\label{chapter2eq:15}\\
\frac{9}{21}\hat{f}_{4-\frac{1}{2}}+\frac{12}{21}\hat{f}_{4+\frac{1}{2}} & =\frac{2}{42}f_{3}+\frac{35}{42}f_{4}+\frac{5}{42}f_{5}\label{chapter2eq:16}\\
\frac{2}{3}\hat{f}_{5-\frac{1}{2}}+\frac{1}{3}\hat{f}_{5+\frac{1}{2}} & =\frac{1}{6}f_{4}+\frac{5}{6}f_{5}\label{chapter2eq:17}
\end{flalign}
\eqref{chapter2eq:12}-\eqref{chapter2eq:17} 可以被写为矩阵形式:
\begin{equation}\label{chapter2eq:18}
\begin{split}
&\left(\begin{matrix}
   {}^{2}/{}_{3} & {}^{1}/{}_{3} & 0 & 0 & 0 & 0  \\
   {}^{5}/{}_{24} & {}^{2}/{}_{3} & {}^{3}/{}_{24} & 0 & 0 & 0  \\
   0 & {}^{3}/{}_{10} & {}^{6}/{}_{10} & {}^{1}/{}_{10} & 0 & 0 \\
   0 & 0 & {}^{3}/{}_{10} & {}^{6}/{}_{10} & {}^{1}/{}_{10} & 0  \\
   0 & 0 & 0 & {}^{9}/{}_{21} & {}^{12}/{}_{21} & 0  \\
   0 & 0 & 0 & 0 & {}^{2}/{}_{3} & {}^{1}/{}_{3}  \\
\end{matrix} \right)\left( \begin{matrix}
   {\hat{f}_{0+\frac{1}{2}}}  \\
   {\hat{f}_{1+\frac{1}{2}}}  \\
   {\hat{f}_{2+\frac{1}{2}}}  \\
   {\hat{f}_{3+\frac{1}{2}}}  \\
   {\hat{f}_{4+\frac{1}{2}}}  \\
   {\hat{f}_{5+\frac{1}{2}}}  \\
\end{matrix} \right)\\
=&\left( \begin{matrix}
   {}^{1}/{}_{6} & {}^{5}/{}_{6} & 0 & 0 & 0 & 0  \\
   0 & {}^{28}/{}_{48} & {}^{20}/{}_{48} & 0 & 0 & 0  \\
   0 & {}^{1}/{}_{30} & {}^{19}/{}_{30} & {}^{1}/{}_{3} & 0 & 0 \\
   0 & 0 & {}^{1}/{}_{30} & {}^{19}/{}_{30} & {}^{1}/{}_{3} & 0  \\
   0 & 0 & 0 & {}^{2}/{}_{42} & {}^{35}/{}_{42} & {}^{5}/{}_{42}  \\
   0 & 0 & 0 & 0 & {}^{1}/{}_{6} & {}^{5}/{}_{6}  \\
\end{matrix} \right)\left( \begin{matrix}
   {{f}_{0}}  \\
   {{f}_{1}}  \\
   {{f}_{2}}  \\
   {{f}_{3}}  \\
   {{f}_{4}}  \\
   {{f}_{5}}  \\
\end{matrix} \right)
\end{split}
\end{equation}
注意到 ${\hat{f}_{i+1/2}}-{\hat{f}_{i-1/2}}=\Delta xf_{i}^{'}$, 我们定义一个矩阵C:
\begin{equation}\label{chapter2eq:19}
C=\left[ \begin{matrix}
   0 & 0 & 0 & 0 & 0 & 0   \\
   -1 & 1 & {} & {} & {} & {}  \\
   {} & -1 & 1 & {} & {} & {}  \\
   {} & {} & -1 & 1 & {} & {}  \\
   {} & {} & {} & -1 & 1 & {}  \\
   {} & {} & {} & {} & -1 & 1  \\
\end{matrix} \right]
\end{equation}
在方程 \eqref{chapter2eq:18}每侧左乘矩阵C, 我们可以得到关于$f'_i$的线性方程组:
\begin{equation}\label{chapter2eq:20}
\left[ \begin{matrix}
   0  \\
   f_{1}^{'}  \\
   f_{2}^{'}  \\
   f_{3}^{'}  \\
   f_{4}^{'}  \\
   f_{5}^{'}  \\
\end{matrix} \right]=\frac{1}{\Delta x}\left[ \begin{matrix}
   0 & 0 & 0 & 0 & 0 & 0  \\
   -1 & 1 & {} & {} & {} & {}  \\
   {} & -1 & 1 & {} & {} & {}  \\
   {} & {} & -1 & 1 & {} & {}  \\
   {} & {} & {} & -1 & 1 & {}  \\
   {} & {} & {} & {} & -1 & 1  \\
\end{matrix} \right]\left[ \begin{matrix}
    {\hat{f}_{0+\frac{1}{2}}}  \\
   {\hat{f}_{1+\frac{1}{2}}}  \\
   {\hat{f}_{2+\frac{1}{2}}}  \\
   {\hat{f}_{3+\frac{1}{2}}}  \\
   {\hat{f}_{4+\frac{1}{2}}}  \\
   {\hat{f}_{5+\frac{1}{2}}}  \\
\end{matrix} \right]=\frac{1}{\Delta x}C{{A}^{-1}}B\left[ \begin{matrix}
   {{f}_{0}}  \\
   {{f}_{1}}  \\
   {{f}_{2}}  \\
   {{f}_{3}}  \\
   {{f}_{4}}  \\
   {{f}_{5}}  \\
\end{matrix} \right]
\end{equation}
其中
\begin{equation}\label{chapter2eq:21}
C{{A}^{-1}}B=\left( \begin{matrix}
   0 & 0 & 0 & 0 & 0 & 0  \\
   {}^{-49}/{}_{120} & {}^{-7}/{}_{24} & {}^{149}/{}_{180} & {}^{-3}/{}_{20} & {}^{1}/{}_{40} & {}^{-1}/{}_{360}  \\
   {}^{59}/{}_{360} & {}^{-67}/{}_{72} & {}^{54}/{}_{161} & {}^{11}/{}_{20} & {}^{-11}/{}_{120} & {}^{-11}/{}_{1080}  \\
   {}^{-11}/{}_{120} & {}^{11}/{}_{20} & {}^{-229}/{}_{180} & {}^{29}/{}_{60} & {}^{19}/{}_{40}  & {}^{-19}/{}_{360}  \\
   {}^{7}/{}_{120} & {}^{-7}/{}_{24} & {}^{133}/{}_{180} & {}^{-31}/{}_{20} & {}^{91}/{}_{120}  & {}^{103}/{}_{360} \\
   {}^{-3}/{}_{40} & {}^{3}/{}_{8} & {}^{-19}/{}_{20} & {}^{37}/{}_{20} & {}^{-199}/{}_{40}  & {}^{71}/{}_{40} \\
\end{matrix} \right)
\end{equation}
这样数值通量的一阶导数 $f'_i$ 现在由各个点上的值表达出来。为了分析$f'_i$的精度, 我们对各个从方程\eqref{chapter2eq:20}得到的$f'_i$进行Taylor展开，可以得到:
\begin{subequations}
\begin{eqnarray}
   f_{1}^{'} &=\frac{\partial f}{\partial x}|_1+\tfrac{4}{45}f_{1}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:22} \\
   f_{2}^{'}&=\frac{\partial f}{\partial x}|_2-\tfrac{13}{270}f_{2}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:23} \\
   f_{3}^{'}&=\frac{\partial f}{\partial x}|_3+\tfrac{1}{45}f_{3}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:24} \\
   f_{4}^{'}&=\frac{\partial f}{\partial x}|_4+\tfrac{1}{90}f_{4}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:25} \\
   f_{5}^{'}&=\frac{\partial f}{\partial x}|_5-\tfrac{2}{15}f_{5}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:26}
\end{eqnarray}
\end{subequations}
方程\eqref{chapter2eq:22}-\eqref{chapter2eq:26} 说明点1-5上的一阶导数只有二阶精度。由于相邻点间的关系由方程\eqref{chapter2eq:20}决定, 当一点的相邻点精度降低时, 这个点的精度也会降低, 即使对于完全不包含间断的光滑点如点3。
\section{多步加权CRWENO格式}
正如上面提到的，激波附近的点只有二阶精度。为了提高精度，在此提出一种多步重构的方法。首先，用三个三阶格式中的两个构建两个四阶格式。例如，四阶格式\eqref{chapter2eq:29}是从\eqref{chapter2eq:27} 和 \eqref{chapter2eq:28}被构建，即，$\eqref{chapter2eq:29}=\eqref{chapter2eq:27}\times c_0^0+\eqref{chapter2eq:28}\times c_1^0$。注意到，出于迎风性的考虑，在不损失精度和谱分辨率的前提下，\eqref{chapter1eq:21b}被替换为\eqref{chapter2eq:28} 或 \eqref{chapter2eq:30}：
\begin{align}
&\frac{2}{3}\hat f_{i-\frac{1}{2}}+\frac{1}{3}\hat f_{i+\frac{1}{2}} =\frac{1}{6}f_{i-1}+\frac{5}{6}f_{i},\ &c^{0}_{0}=\frac{3}{4}\label{chapter2eq:27}\\
&\hat f_{i+\frac{1}{2}} =\frac{2}{6}f_{i+1}+\frac{5}{6}f_{i}-\frac{1}{6}f_{i-1},\ &c^{0}_{1}=\frac{1}{4}\label{chapter2eq:28} \\
&\frac{1}{2}\hat f_{i-\frac{1}{2}}+\frac{1}{2}\hat f_{i+\frac{1}{2}} =\frac{1}{12}f_{i+1}+\frac{5}{6}f_{i}+\frac{1}{12}f_{i-1}\label{chapter2eq:29}
\end{align}
类似的对于第二个和第三个模板有:
\begin{align}
&\hat f_{i+\frac{1}{2}} =\frac{2}{6}f_{i+1}+\frac{5}{6}f_{i}-\frac{1}{6}f_{i-1},\ &c^{1}_{0}=\frac{1}{4}\label{chapter2eq:30} \\
&\frac{2}{3}\hat f_{i+\frac{1}{2}}+\frac{1}{3}\hat f_{i+\frac{3}{2}} =\frac{5}{6}f_{i+1}+\frac{1}{6}f_{i},\ &c^{1}_{1}=\frac{3}{4}\label{chapter2eq:31} \\
&\frac{3}{4}\hat f_{i+\frac{1}{2}}+\frac{1}{4}\hat f_{i+\frac{3}{2}} =\frac{17}{24}f_{i+1}+\frac{8}{24}f_{i}-\frac{1}{24}f_{i-1}\label{chapter2eq:32}
\end{align}
然后，这两个四阶格式, \eqref{chapter2eq:29} 和 \eqref{chapter2eq:32}, 通过权重$c_{0}$和$c_{1}$被用来构建最终的五阶格式:
\begin{align}
\nonumber &\frac{1}{2}\hat f_{i-\frac{1}{2}}+\frac{1}{2}\hat f_{i+\frac{1}{2}} =\frac{1}{12}f_{i+1}+\frac{5}{6}f_{i}+\frac{1}{12}f_{i-1}, &c_{0}=0.6\\
\nonumber &\frac{3}{4}\hat f_{i+\frac{1}{2}}+\frac{1}{4}\hat f_{i+\frac{3}{2}} =\frac{17}{24}f_{i+1}+\frac{8}{24}f_{i}-\frac{1}{24}f_{i-1}, &c_{1}=0.4\\
&\frac{3}{10}\hat{f}_{i+\frac{1}{1}}+\frac{6}{10}\hat{f}_{i+\frac{1}{1}}+\frac{1}{10}\hat{f}_{i+\frac{1}{1}}=\frac{1}{30}f_{i-1}+\frac{19}{30}f_i+\frac{10}{30}f_{i+1}\label{chapter2eq:33}
\end{align}
即$\eqref{chapter2eq:33}=\eqref{chapter2eq:29}\times c_0+\eqref{chapter2eq:32}\times c_1$。将\eqref{chapter2eq:29}, \eqref{chapter2eq:32} 和 \eqref{chapter2eq:33}中的理想权重系数替换为非线性权函数, 我们可以得到最终的五阶加权紧致格式：
\begin{align}
a_i\hat f_{i-\frac{1}{2}}+b_i\hat f_{i+\frac{1}{2}}+c_i\hat f_{i+\frac{3}{2}}=d_{i+\frac{1}{2}}\label{chapter2eq:34}
\end{align}
其中 :
\begin{align}
&a_i=\frac{2}{3}\omega_0\omega^{0}_{0}\label{chapter2eq:35}\\
&b_i=\frac{1}{3}(\omega_0\omega^{0}_{0}+3\omega_0\omega^{0}_{1}+3\omega_1\omega^{1}_{0}+2\omega_1\omega^{1}_{1})\label{chapter2eq:36}\\
&c_i=\frac{1}{3}\omega_1\omega^{1}_{1}\label{chapter2eq:37} \\
\begin{split}
& d_{i+\frac{1}{2}}=\frac{1}{6}(\omega_0\omega^{0}_{0}-\omega_0\omega^{0}_{1}-\omega_1\omega^{1}_{0})f_{i-1}+\frac{1}{6}(5\omega_0\omega^{0}_{0}+5\omega_0\omega^{0}_{1}+5\omega_1\omega^{1}_{0}+\omega_1\omega^{1}_{1})f_{i} \\
& +\frac{1}{6}(2\omega_0\omega^{0}_{1}+2\omega_1\omega^{1}_{1}+5\omega_1\omega^{1}_{1})f_{i+1}\label{chapter2eq:38}
\end{split}
\end{align}
为了保证收敛精度:
\begin{align}\label{chapter2eq:39}
\omega_{k}-c_{k}=O(\Delta x^3),
\end{align}
映射函数 \eqref{chapter1eq:18} 在每一步计算非线性加权函数时都被使用到。非线性加权函数被重新写为:
\begin{align}
\nonumber &\omega _{k}^{l}=\frac{g(\psi _{k}^{l})}{\sum\limits_{i}{g(\psi _{i}^{l})}},\psi _{k}^{l}=\frac{a_{k}^{l}}{\sum\limits_{{i}}{a_{i}^{l}}},a_{k}^{l}=c_{k}^{l}(1+\frac{\tau _{4}^{l}}{{{\beta }_{k+l}}+\varepsilon }),\ \tau _{4}^{l}=\left| {{\beta }_{l+1}}-{{\beta }_{l}} \right|,k=0,1,\ l=0,1 \\
\nonumber &\omega _{k}=\frac{g({{\psi }_{m}})}{\sum\limits_{i}{g({{\psi }_{i}})}},{{\psi }_{m}}=\frac{{{a}_{m}}}{\sum\limits_{i}{{{a}_{i}}}},{{a}_{m}}={{c}_{m}}(1+\frac{{{\tau }_{5}}}{{{\beta }_{2m}}+\varepsilon }),\ {{\tau }_{5}}=\left| {{\beta }_{2}}-{{\beta }_{0}} \right|,m=0,1.
\end{align}
$\beta_k$ 的定义与\eqref{chapter1eq:17a}-\eqref{chapter1eq:17c}中的一致.

通过与\ref{accuracy analysis}节中相同的分析方法, 我们可以得到多步加权CRWENO格式在激波附近的精度。 在此我们略过分析过程，直接给出结果。对于图\ref{chapter2fig:sketch}中的每个点有:
\begin{subequations}
 \begin{align}
  & f_{1}^{'}=\frac{\partial f}{\partial x}|_1+\tfrac{1}{24}f_{1}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:40}\\
  & f_{2}^{'}=\frac{\partial f}{\partial x}|_2+\tfrac{13}{396}f_{2}^{(4)}\Delta {{x}^{3}}+O(\Delta {{x}^{4}})\label{chapter2eq:41}\\
  & f_{3}^{'}=\frac{\partial f}{\partial x}|_3-\tfrac{1}{44}f_{3}^{(4)}\Delta {{x}^{3}}+O(\Delta {{x}^{4}})\label{chapter2eq:42}\\
  & f_{4}^{'}=\frac{\partial f}{\partial x}|_4+\tfrac{5}{132}f_{4}^{(4)}\Delta {{x}^{3}}+O(\Delta {{x}^{4}})\label{chapter2eq:43}\\
  & f_{5}^{'}=\frac{\partial f}{\partial x}|_5-\tfrac{1}{12}f_{5}^{(3)}\Delta {{x}^{2}}+O(\Delta {{x}^{3}})\label{chapter2eq:44}
 \end{align}
\end{subequations}
方程\eqref{chapter2eq:40}-\eqref{chapter2eq:44} 表明所提出的多步加权方法将  $f_{2}^{'}$, $f_{3}^{'}$ 和 $f_{4}^{'}$的精度从二阶提高到三阶. 除此之外, 余项\eqref{chapter2eq:40}和\eqref{chapter2eq:44}的系数与\eqref{chapter2eq:22}和\eqref{chapter2eq:26}也减半。

一个格式的耗散和色散特性可以通过傅里叶分析得到\cite{lele1992compact}。 考虑一个均匀网格上周期通量函数$f_N(x)$的傅里叶分解：
\begin{equation}\label{chapter2eq:fourier1}
f_N(x)=\sum_{k=0}^{N-1}\hat{f}_k \text{exp}(\frac{2 \pi i k x}{L}),
\end{equation}
其中 $i=\sqrt{-1}$. 通过对\eqref{chapter2eq:fourier1}微分可以得到通量$f_N(x)$一阶导数的傅里叶分解:
\begin{equation}\label{chapter2eq:fourier2}
f'_N(s)=\sum_{k=0}^{N-1}\hat{f'}_k \text{exp}(\frac{2 \pi i k x}{L})=\sum_{k=0}^{N-1}i\omega\hat{f}_k \text{exp}(i\omega s),
\end{equation}
其中 $\omega=2\pi k\Delta x/L=2\pi k /N$ 是波数而$s=x/\Delta x$是坐标 \cite{lele1992compact}。对于由线性格式得到的导数，修正波数被定义为$\omega'=-i(\hat{f'}_k)/\hat{f}_k$，它可以通过将$f'=\frac{1}{\Delta x}\sum_{n}f_n$中的$f_n$ 替换为$\hat{f}\text{exp}(i\omega n)$ 以及 $f'$替换为$i(\omega')\hat{f}\text{exp}(i\omega n)$得到。然而，这对于像WENO格式和CRWENO格式这样的非线性格式并不成立。为了分析非线性格式的谱特性，需要通过考虑所有傅里叶模态而不是单一模态来扩展标准的傅里叶方法\cite{zhao2014comparison,pirozzoli2006spectral}。
非线性格式的修正波数 $\omega'(\omega)$被定义为：
\begin{equation}\label{chapter2eq:fourier3}
\omega'(\omega)=\frac{1}{i}\sum_{n=0}^{N-1}f'_i \text{exp}(-i\omega n)/\sum_{n=0}^{N-1}f_i \text{exp}(-i\omega n),
\end{equation}
其中 $f'_i$ 是通过非线性格式得到的傅里叶系数。

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/MWN-real.pdf}
\caption{不同格式修正波数的实部}
\label{chapter2fig:MWN-real}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/MWN-imag-eps-converted-to}
\caption{不同格式修正波数的虚部}
\label{chapter2fig:MWN-imag}
\end{center}
\end{figure}

图\ref{chapter2fig:MWN-real}和\ref{chapter2fig:MWN-imag}分别给出了WENO-Z格式，CRWENO格式和本文中所提出格式的修正波数的实部和虚部，它们对应的线性格式，五阶迎风格式(UW5)和五阶迎风紧致格式(UWC5) 的修正波数也被一同给出。可以看出，由于加权函数引入的非线性效应，非线性格式要比它们对应的线性格式具有更大的耗散性。 这一现象在文献\cite{Jia2014dk} 中也被提到。CRWENO格式的谱特性被多步加权方法显著地提升。

\section{数值实验}
为了分析多步加权CRWENO格式, 我们进行了多种数值实验包括标量、一维和二维问题，并与WENO-Z格式和CRWENO格式进行比较。

对于本节中的所有数值实验, 三阶TVD Runge-Kutta\cite{shu1988total}方法被用作时间推进：
\begin{align}
&u^{(1)}=u^n+\Delta tL(u^n)\label{chapter2eq:45}\\
&u^{(2)}=\frac{3}{4}u^n+\frac{1}{4}u^{(1)}+\frac{1}{4}\Delta tL(u^{(1)})\label{chapter2eq:46}\\
&u^{n+1}=\frac{1}{3}u^n+\frac{2}{3}u^{(2)}+\frac{2}{3}\Delta tL(u^{(2)})\label{chapter2eq:47}.
\end{align}
对于具有强间断的一维问题，特征变量重构采用了文献
\cite{ghosh2012compact}中建议的Lax-Friedrich\cite{lax1954weak}通量分裂方法。对于二维问题，本文采用Steger-Warming通量分裂方法\cite{steger1981flux}。
\subsection{线性对流方程}
我们考虑线性波的传播问题。线性对流方程为:
\begin{align}\label{chapter2eq:linear}
\begin{cases}
u_t+u_x=0 \quad & -1\leqslant x\leqslant1,\\
u(x,0)=u_0(x) \quad & \text{periodic boundary}.
\end{cases}
\end{align}
方程\eqref{chapter2eq:linear}在时刻$t$和初始条件$u_0(x)$下的准确解为：
\begin{equation}
u(x,t)=u_0(x-t).
\end{equation}

本节中考察两个例子。第一个例子考察格式对于光滑解的收敛性。初始条件为：
\begin{align}\label{linearInitial1}
u_0(x)=\text{sin} \pi x
\end{align}
计算区域采用均匀网格。为了去除由时间离散带来的误差，时间步长$\Delta t$被设为$\Delta x^{5/3}$。
\begin{table}[htbp]
  \caption{线性对流方程初始条件\eqref{linearInitial1}下，t=2时不同格式的$L_2$误差和收敛阶数}\label{convergence}
  \begin{center}\footnotesize
  \begin{tabular}{ccccccc}
  \toprule
  \multirow{2}{*}{N} &
  \multicolumn{2}{c}{WENO-Z} &
  \multicolumn{2}{c}{CRWENO} &
  \multicolumn{2}{c}{Present} \\
  %\cline{2-7}
  & $L_2$ & order & $L_2$ & order & $L_2$ & order \\
  \midrule
  20 & 2.26E-004 & - & 8.29E-005 & - & 8.36E-005 & - \\
  40 & 7.08E-006 & 5.00 & 3.31E-006 & 4.78 & 3.31E-006 & 4.78 \\
  80 & 2.22E-007 & 5.00 & 1.10E-007 & 5.01 & 1.10E-007 & 5.01 \\
  160 & 6.98E-009 & 4.92 & 3.20E-009 & 5.85 & 3.20E-009 & 5.85 \\
  320 & 2.41E-010 & 4.86 & 3.29E-011 & 6.60 & 3.29E-011 & 6.60 \\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}
误差的$L_2$范数通过与精确解在$t=2$时根据下式得到：
$$
L_2=\sqrt{\frac{1}{N}\sum_{i=1}^N{\left(u_i-u_{exact,i}\right)^2}}
$$
表\ref{convergence}展示了不同格式的$L_2$范数和收敛阶数。所有格式都达到五阶，但两个加权紧致格式比WENO-Z格式更为精确。CRWENO格式和多步加权CRWENO格式的误差基本一致说明为提高激波附近精度设计的多步加权方法不会给光滑解带来额外的误差。

第二个算例的初始条件为:
\begin{align}\label{composedwave}
& u_0(x)=
\begin{cases}
\frac{1}{6}(G(x,\beta,z-\delta)+G(x,\beta,z+\delta)+4G(x,\beta,z)), &  -0.8 \leqslant x < -0.6 \\
1, &  -0.4 \leqslant x < -0.2 \\
1-|10(x-0.1)|, &  0 \leqslant x < 0.2 \\
\frac{1}{6}(F(x,\alpha,a-\delta)+F(x,\alpha,a+\delta)+4F(x,\alpha,a)),& 0.4 \leqslant x < 0.6\\
0, & otherwise
\end{cases}&
\end{align}
其中
\begin{align}
\nonumber &G(x,\beta,z)=e^{-\beta (x-z)^2}, F(x,\alpha,a)=\sqrt{\text{max}(1-\alpha^{2}(x-a)^2,0)}, \\
\nonumber &a=0.5, z=-0.7, \delta=0.005, \alpha=10, \beta=\text{log}2/36\delta^2.
\end{align}

初始条件\eqref{composedwave}的解包含了一个光滑但是狭窄的高斯波、一个方波、一个尖锐的三角波和一个半椭圆波\cite{jiang1996efficient}。由于这个例子是光滑函数和不光滑函数的组合，它被广泛用于测试一个格式的间断捕捉能力\cite{Balsara2000monotonicity}。不同格式的数值结果在图\ref{chapter2fig:linear}中给出。本文所提出格式的间断捕捉能力显著好于其他两种格式 (见图\ref{chapter2fig:linear2})。
\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/composed-c.eps}
\caption{不同格式对线性输运方程初始条件\eqref{composedwave}在t=6时的解, N=200}
\label{chapter2fig:linear}
\end{center}
\end{figure}
\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/composed-mag.eps}
\caption{方波的放大图}
\label{chapter2fig:linear2}
\end{center}
\end{figure}

\subsection{一维欧拉方程}
一维欧拉方程为：
\begin{align}\label{chapter2eq:euler1d}
U_t+F(U)_x=0
\end{align}
其中 $U=(\rho,\rho u,e)^T$，$F(U)=(\rho u,\rho u^2+p, u(e+p))^T$。这里$\rho$是密度，$u$是速度，$e$ 是总能量，$p$是压力，对于理想气体有$e=\frac{p}{\gamma-1}+\frac{1}{2}\rho u^2$，$\gamma=1.4$是比热比。

三个典型的算例被考察，第一个算例是Sod激波管问题，初始条件为：
\begin{flalign}
\nonumber &(\rho,u,p)=
\begin{cases}
(1,0,1)& x \leqslant 0 \\
(0.125,0,0.1)& x>0
\end{cases}&
\end{flalign}
零压力边界条件被施加在 $x=\pm 0.5$。

第二个算例是Lax问题, 初始条件为：
\begin{flalign}
\nonumber &(\rho,u,p)=
\begin{cases}
(0.445,0.698,3.528)& x\leqslant0\\
(0.5,0,0.571)& x>0
\end{cases}&
\end{flalign}
$x=\pm 0.5$处为零梯度条件。

第三个问题为Shu-Osher问题，它描述的是3马赫激波与密度波的相互作用。初始条件为：
\begin{flalign}
\nonumber &(\rho,u,p)=
\begin{cases}
(\frac{27}{7},\frac{4\sqrt{35}}{9},\frac{31}{3})& x<-4\\
(1+\frac{1}{5}sin5x,0,1)& x\geqslant -4
\end{cases}&
\end{flalign}
零梯度条件被施加在$x=\pm5$。

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/sod-c.eps}
\caption{Sod问题在t=0.14时的解, N=200}
\label{chapter2fig:sod}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/lax-c.eps}
\caption{Lax问题在t=0.13时的解, N=200}
\label{chapter2fig:lax}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/shuosher.eps}
\caption{Shu-Osher问题在t=1.8时的解, N=200}
\label{chapter2fig:shuosher1}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/1d/shuosher-mag.eps}
\caption{Shu-Osher问题局部放大}
\label{chapter2fig:shuosher2}
\end{center}
\end{figure}

图\ref{chapter2fig:sod}到图\ref{chapter2fig:shuosher2}给出了不同问题在相应时刻的密度分布。参考解是在网格N=2000时由CRWENO格式计算获得。对于两个激波管问题，即Lax问题和Sod问题，所有的格式都给出了相近的结果。CRWENO格式和多步加权CRWENO格式比WENO-Z格式在激波附近的表现更好。由于激波结构较为简单, 多步加权CRWENO格式和CRWENO格式的差别不明显, 尽管可以看出本文所提出的格式要优于CRWENO格式。一个更复杂的例子，Shu-Osher问题，能够展现所测试格式间的区别。多步加权方法对小尺度波的分辨率最好，在激波附近，本方法也有更高的精度。

\subsection{二维欧拉方程}
理想气体的二维欧拉方程为：
\begin{align}\label{chapter2eq:euler2d}
U_t+F_x+G_y=0
\end{align}
其中向量 U, F, G 为：
\begin{equation}
\begin{split}
&U=\left[\begin{matrix}
\rho\\
\rho u\\
\rho v\\
e\\
\end{matrix}
\right],\
F=\left[\begin{matrix}
\rho u\\
\rho u^2+p\\
\rho uv\\
eu+pu\\
\end{matrix}
\right],\
G=\left[\begin{matrix}
\rho v\\
\rho uv\\
\rho v^2+p\\
ev+pv\\
\end{matrix}
\right]
\end{split}
\end{equation}
在这一部分两个算例被用来测试WENO-Z格式，CRWENO格式和多步加权CRWENO格式。第一个算例是模拟一个等熵涡在计算区域进行周期性穿越。这个算例在文献\cite{davoudzadeh1995accuracy} 给出，被用来测试一个格式对于欧拉方程光滑解的耗散性。第二个算例是双马赫反射问题。除了强激波，在双马赫反射问题的解中还包含了一些小尺度结构。因此它是一个用来测试存在激波情况下格式对小尺度结构分辨率的好例子。

\subsubsection{等熵涡对流问题}\label{chapter2sec:ivc}
这个问题被用来测试格式的耗散性\cite{davoudzadeh1995accuracy}。一个等熵涡周期性的在计算区域中移动。计算区域的尺寸为 $[0,10]\times[0,10]$，自由流条件为$\rho_{\infty}=1, u_{\infty}=0.5, v_{\infty}=0, p_{\infty}=1$。流场的初始条件为：
\begin{align}
&\rho=[1-\frac{(\gamma-1)b^2}{8\gamma\pi^2}e^{1-r^2}]^{\frac{1}{\gamma-1}};\ p=\rho^{\gamma}\\
&\delta u=-\frac{b}{2\pi}e^{\frac{1-r^2}{2}}(y-y_c)\\
&\delta v=\frac{b}{2\pi}e^{\frac{1-r^2}{2}}(x-x_c)
\end{align}
其中 $r^2=(x-x_c)^2+(y-y_c)^2$ 是到涡心$(x_c,y_c)=(5,5)$的距离，涡强度$b$为$0.5$。所有边界处都为周期边界条件。耗散由动能在计算域上的积分随时间的变化来体现：$E_k=\sum_{i,j}0.5\rho_{i,j} (u_{i,j}^2+v_{i,j}^2)$。
\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/ivc/kinetic.eps}
\caption{涡对流问题中动能的积分随时间变化分布}
\label{chapter2fig:kinetic energy}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/images/ivc/p-center.eps}
\caption{不同格式在 y=5 处的压力分布， t=2000}
\label{chapter2fig:pressure}
\end{center}
\end{figure}

图\ref{chapter2fig:kinetic energy}展示了不同格式获得的动能积分时间变化曲线。多步加权方法和CRWENO格式对动能的耗散要略小于WENO-Z格式。这一结果也可以从压力的分布中得到（图\ref{chapter2fig:pressure}）， WENO-Z 格式在涡中心处压力分布极大的偏离了初始值。CRWENO格式和多步加权格式的最低压力基本一致。因此，就动能的耗散来说, 正如一维线性方程计算结果所展示的那样, 多步加权格式并不会给二维光滑流动解带来额外的误差。.

\begin{figure}[!htbp]
\begin{center}
\subfigure[WENO-Z]{
\includegraphics[width=0.45\textwidth]{figures/images/ivc/weno-ivc.eps}}
\subfigure[CRWENO]{
\includegraphics[width=0.45\textwidth]{figures/images/ivc/crweno-ivc.eps}}
\subfigure[Present]{
\includegraphics[width=0.45\textwidth]{figures/images/ivc/mscw-ivc.eps}}
\subfigure[Initial]{
\includegraphics[width=0.45\textwidth]{figures/images/ivc/reference-ivc.eps}}
\caption{等熵涡对流问题在 t=2000时不同格式所获得的密度云图: 云图范围从 0.9939 到 1 分为 20 相等的区域}
\label{chapter2fig:ivc}
\end{center}
\end{figure}

然而，对涡形状的保持能力对于长时间的模拟如大涡模拟和直接数值模拟来说非常重要。从不同格式在$t=2000$时计算结果的密度分布云图\ref{chapter2fig:ivc}中可以看到，WENO-Z格式所获得的涡发生了极大的扭曲，而CRWENO格式则给出了一个稍微变形的涡。多步加权方法使得CRWENO格式有了更好的涡保持能力。 多步加权方法和CRWENO格式的耗散性是基本一致的，然而更好的涡保持能力表明多步加权方法更适合于长时间的复杂流动模拟。

\subsubsection{双马赫反射}
双马赫问题模拟的是一个空气中的平面激波在楔角上的反射过程。它被作为一个算例广泛用于测试格式的激波捕捉能力和小尺度结构分辨率。在本模拟中，计算区域为 $[0,4]\times[0,1]$。下边界被设置为反射壁面，从$x=\frac{1}{6}$开始。 在$t=0$时刻, 一个向右移动的$60^\circ$倾角10马赫激波被放置在$(\frac{1}{6} ,0)$处。上边界被设置为描述马赫10激波的准确运动。左边界在$x=0$处被设置了激波后条件。出口条件被设置在$x=4$ 处。关于双马赫反射问题的详细描述可以参考 \cite{woodward1984numerical}。网格尺寸为 $\Delta x=\Delta y=\frac{1}{240}$的均匀网格被使用。参考解由CRWENO格式在$\Delta x=\Delta y=\frac{1}{480}$的网格上获得。
\begin{figure}[!htbp]
\begin{center}
\subfigure[WENO-Z]{
\includegraphics[width=0.9\textwidth]{figures/images/double-mach/weno-rho.eps}}
\subfigure[CRWENO]{
\includegraphics[width=0.9\textwidth]{figures/images/double-mach/crweno-rho.eps}}
\subfigure[Present]{
\includegraphics[width=0.9\textwidth]{figures/images/double-mach/mscw-rho.eps}}
\subfigure[Reference]{
\includegraphics[width=0.9\textwidth]{figures/images/double-mach/reference-rho.eps}}
\caption{双马赫反射问题在t=0.2时刻的密度分布云图}
\label{chapter2fig:doublemach1}
\end{center}
\end{figure}
\begin{figure}[!htbp]
\begin{center}
\subfigure[WENO-Z]{
\includegraphics[width=0.45\textwidth]{figures/images/double-mach/weno-rho-mag.eps}}
\subfigure[CRWENO]{
\includegraphics[width=0.45\textwidth]{figures/images/double-mach/crweno-rho-mag.eps}}
\subfigure[Present]{
\includegraphics[width=0.45\textwidth]{figures/images/double-mach/mscw-rho-mag.eps}}
\subfigure[Reference]{
\includegraphics[width=0.45\textwidth]{figures/images/double-mach/reference-rho-mag.eps}}
\caption{双马赫反射在t=0.2时刻上卷区域的密度分布云图}
\label{chapter2fig:doublemach2}
\end{center}
\end{figure}

图\ref{chapter2fig:doublemach1}给出了在$t=0.2$时刻不同格式所获得的密度云图。所有格式都很好的捕捉了激波。从上卷区域的局部放大图\ref{chapter2fig:doublemach2}中可以看出，与参考解相比, 多步加权方法有更高的分辨率。WENO-Z格式能够在上卷区域分辨出一些小尺度结构，但是由于在激波附近分辨率低，不能分辨接触间断附近的小尺度结构。CRWENO格式在间断处的小尺度结构分辨率也并不令人满意，正如\ref{accuracy analysis}中所分析的那样。本方法能够分辨出更好的小尺度结构，这表明本方法在间断附近更为精确且耗散更小。


\subsection{激波/剪切层相互作用}
激波剪切层相互作用问题被设计用来考察格式在激波与涡发生相互作用时的分辨率\cite{yee1999low}。 一个马赫$0.6$的混合层发展并与一个斜激波发生碰撞。由于混合层不稳定所产生的涡通过斜激波及其在壁面上的反射波。计算区域为$[0,200]\times[-20,20]$。在$x=0$, 入口条件被设定为：
\begin{equation}
\nonumber u=2.5+0.5\text{tanh}(2y)
\end{equation}
对于上层流动($y>0$), $\rho=1.6374$, $p=0.3327$；对于下层流动 ($y<0$), $\rho=0.3626$, $p=0.3327$。激波后条件被设置在上边界，滑移壁面条件被设置在下边界。法向速度扰动被加在入口处：
\begin{align}
\nonumber v^{'}=\sum_{k=1}^{2}a_k\text{cos}(2\pi kt/T+\phi_k)\text{exp}(-y^2/b) \\
\nonumber b=10, a_1=a_2=0.05, \phi_1=0, \phi_2=\pi/2
\end{align}
其中$T=\lambda /u_c$是周期, $\lambda=30$是波长, $u_c=2.68$是对流速度。普朗特数Pr被设为0.72，雷诺数Re为500。

\begin{figure}[p]
\begin{center}
\subfigure[WENO-Z]{
\includegraphics[width=\textwidth]{figures/images/shock-shear/shockshear-weno.eps}}
\subfigure[CRWENO]{
\includegraphics[width=\textwidth]{figures/images/shock-shear/shockshear-crweno.eps}}
\subfigure[Present]{
\includegraphics[width=\textwidth]{figures/images/shock-shear/shockshear-mscw.eps}}
\subfigure[Reference]{
\includegraphics[width=\textwidth]{figures/images/shock-shear/shockshear-ref.eps}}
\caption{激波/剪切层相互作用在t=120时刻的密度云图}
\label{chapter2fig:shockshear}
\end{center}
\end{figure}

理想气体的二维Navier-Stokes方程为 :
\begin{align}\label{chapter2eq:ns2d}
U_t+F_x+G_y=\frac{1}{Re}F^v_x+\frac{1}{Re}G^v_y
\end{align}
其中向量 U, F, G, $F^v$, $G^v$ 为:
\begin{equation}
\begin{split}
&U=\left[\begin{matrix}
\rho\\
\rho u\\
\rho v\\
e\\
\end{matrix}
\right],\
F=\left[\begin{matrix}
\rho u\\
\rho u^2+p\\
\rho uv\\
eu+pu\\
\end{matrix}
\right],\
G=\left[\begin{matrix}
\rho v\\
\rho uv\\
\rho v^2+p\\
ev+pv\\
\end{matrix}
\right],\\
&F^v=\left[\begin{matrix}
0\\
\tau_{xx}\\
\tau_{xy}\\
u\tau_{xx}+v\tau_{xy}+q_x\\
\end{matrix}
\right],\
G^v=\left[\begin{matrix}
0\\
\tau_{yx}\\
\tau_{yy}\\
u\tau_{yx}+v\tau_{yy}+q_y\\
\end{matrix}
\right]
\end{split}
\end{equation}
其中
 \begin{equation}
 \begin{split}
 &\tau_{xx}=\mu (\frac{4}{3}\frac{\partial {u}}{\partial x}-\frac{2}{3}\frac{\partial {v}}{\partial y}),
 \tau_{yy}=\mu (\frac{4}{3}\frac{\partial {v}}{\partial y}-\frac{2}{3}\frac{\partial {u}}{\partial x}), \\
 &\tau_{xy}=\tau_{yx}=\mu (\frac{\partial {u}}{\partial y}+\frac{\partial {v}}{\partial x}), \\
 &q_x=\mu \frac{1}{(\gamma-1)M^2Pr}\frac{\partial T}{\partial x}， \\
 &q_y=\mu \frac{1}{(\gamma-1)M^2Pr}\frac{\partial T}{\partial y}
\end{split}
\end{equation}
粘性项通过四阶中心差分格式离散\cite{shen2009high}。网格数为$321\times81$，一个加密的网格$1284\times324$被用来获得参考解。参考解由CRWENO格式计算得到。

图\ref{chapter2fig:shockshear}给出了不同格式所获得解的密度云图。与其两个格式相比，多步加权格式获得的解最接近参考解。本方法能够更好的分辨斜激波和反射激波附近的涡。除此之外，在出口处的涡形态也得到了更好的保持。

\section{新加权开关函数}\label{sec3}
多步加权方法使得CRWENO格式在激波附近有了更高的精度，然而想要同时实现在光滑区域的低耗散需要其它方法的辅助。构造混合格式是提高激波捕捉格式精度的有效途径。然而在激波捕捉格式和线性格式之间的转换方法决定了混合格式的性能。正如前面提到的，大多数转换方法都引入了经验的、问题相关的参数来开启激波捕捉格式。这些参数会极大地限制混合格式的应用范围。

通过使用公式\eqref{chapter1eq:20}给出的$\alpha_k$, 我们构造了一个高精度的无问题相关参数的加权开关函数：
\begin{equation}\label{chapter3eq:11}
\theta = \frac{1}{1+(\sum_k a_k-1)^2}
\end{equation}
为了分析$\theta$在光滑和间断模板上的精度，我们首先回顾在文献\cite{borges2008improved}中总结的$\tau_5$的主要特点:
\begin{itemize}
\item 如果$S^5$不包含间断, 那么$\tau_5=O(\Delta x^5) \ll \beta_k$， $k=0,1,2$；
\item 如果解在一些 $S_k$上是连续的, 但是在整个$S_5$上是不连续的, 那么对于连续的$k$有$\beta_k\ll \tau_5$；
\item $\tau_5 \leq max_k\beta_k$.
\end{itemize}
因此，对于那些包含间断的模板有：
$$
\sum_k a_k \gg 1
$$
因而，
$$
\theta \rightarrow 0.
$$
对于光滑模板，对光滑因子 $\beta_k$ 和 $\tau_5$在$x_i$做Taylor展开：
\begin{eqnarray}
\nonumber &\beta_0 = & f_i'^{2} \Delta x^2+\left(\frac{13}{12}f_i''^2-\frac{2}{3}f_i'f_i'''\right)\Delta x^4 \\
& &+\left(-\frac{13}{6}f_i''f_i'''+\frac{1}{2}f_i'f_i''''\right)\Delta x^5+O(\Delta x^6),\label{chapter3eq:12} \\
& \beta_1 =& f_i'^{2} \Delta x^2+\left(\frac{13}{12}f_i''^2-\frac{2}{3}f_i'f_i'''\right)\Delta x^4+O(\Delta x^6),\label{chapter3eq:13}\\
\nonumber& \beta_2 =& f_i'^{2} \Delta x^2+\left(\frac{13}{12}f_i''^2-\frac{2}{3}f_i'f_i'''\right)\Delta x^4 \\
& &+\left(\frac{13}{6}f_i''f_i'''-\frac{1}{2}f_i'f_i''''\right)\Delta x^5+O(\Delta x^6)\label{chapter3eq:14}, \\
 & \tau_5=& |\frac{13}{3}f''_if'''_i-f'_if^{(4)}_i|\Delta x^5+O(\Delta x^6),
\end{eqnarray}
以及
\begin{equation}
a_k=c_k\left(1+\left(\frac{\tau_5}{\beta_k+\epsilon}\right)^q\right)=
\begin{cases}
c_k+O(\Delta x^{3q}), & f'\neq 0 \\
c_k+O(\Delta x^q), 	& f'= 0,
\end{cases}
\label{chapter3eq:15}
\end{equation}
我们可以得到$\theta$的截断误差：
\begin{equation}\label{chapter3eq:16}
\theta=\frac{1}{1+(\sum_k a_k-1)^2}=1-O(\Delta x^{p}), \quad p=
\begin{cases}
6q,& f'\neq 0 \\
2q,& f'= 0.
\end{cases}
\end{equation}

\begin{figure}[htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{pic/theta.jpg}
\caption{不同$z$时的$\theta(x)$函数}
\label{chapter3fig:theta function}
\end{center}
\end{figure}

方程\eqref{chapter3eq:16}表明$\theta$在光滑模板上是对1的高阶逼近。显然有:
$$
0< \theta <1
$$

事实上，开关函数$\theta$可以写成更一般的形式：
\begin{equation}\label{chapter3eq:17}
\theta(x)=\frac{1}{1+x^z}, \quad x=\sum_k{a_k}-1
\end{equation}
图\ref{chapter3fig:theta function}绘出了$\theta$随$x$变化的曲线。可以看出，$z$越大，$\theta$向1收敛越快。这一性质使得$\theta$能被灵活的应用于算法设计。

\section{一类低耗散混合激波捕捉格式}\label{sec4}
\subsection{混合方法}
基于$\theta$函数，我们应用下列方法可以将一个线性格式和WENO类型格式混合起来：
\begin{equation}
F_{Hybrid}=(1-\theta)F_{WENO}+\theta F_{Linear}
\end{equation}
其中$F_{WENO}$代表某种WENO格式的表达式（如WENO-Z格式、CRWENO格式等），$F_{Linear}$代表某个高阶线性格式的表达式。对于光滑区域，由于$\theta \approx 1$，$F_{Hybrid}$趋于$F_{Linear}$。对于间断$\theta \approx 0$，$F_{Hybrid}$趋于$F_{WENO}$。这种设计使得$F_{Hybrid}$在间断附近的表现与相应的WENO格式相一致。

在接下来的部分，作为一个例子，我们发展了一种七阶混合格式，并对它的精度进行了分析。
\subsection{混合紧致-CRWENO格式}
研究表明，五阶CRWENO格式比五阶WENO格式更为准确\cite{ghosh2012compact,ghosh2014weighted}。利用七阶迎风紧致格式\eqref{chapter1eq:uwc7}与CRWENO格式使用同样的模板以及相似的隐式表达形式，我们构造了新的混合紧致-CRWENO格式（HCCS）：
\begin{equation}\label{chapter3eq:18}
C_{HCCS}: \tilde{\alpha}_{-1}\hat{f}_{i-\frac{1}{2}}+\tilde{\alpha}_{0}\hat{f}_{i+\frac{1}{2}}+\tilde{\alpha}_{1}\hat{f}_{i+\frac{3}{2}}=\sum_{m=-2}^{2}\tilde{\beta}_m f_{i+m}
\end{equation}
其中 $\tilde{\alpha}_k,\tilde{\beta}_k$ 为:
\begin{eqnarray}
\nonumber &\tilde{\alpha}_{-1}&=\frac{2}{7}\theta+(1-\theta)\left(\frac{2}{3}\omega_0+\frac{1}{3}\omega_1\right), \\
\nonumber&\tilde{\alpha}_{0}&=\frac{4}{7}\theta+(1-\theta)\left(\frac{1}{3}\omega_0+\frac{2}{3}(\omega_1+\omega_2)\right), \\
\nonumber&\tilde{\alpha}_{1}&=\frac{1}{7}\theta+(1-\theta)\frac{1}{3}\omega_3,\\
\nonumber&\tilde{\beta}_{-2}&=-\frac{1}{420}\theta,\\
\nonumber&\tilde{\beta}_{-1}&=\frac{19}{420}\theta+(1-\theta)\frac{\omega_0}{6},\\
\nonumber&\tilde{\beta}_0&=\frac{239}{420}\theta+(1-\theta)\frac{5(\omega_0+\omega_1)+\omega_2}{6},\\
\nonumber&\tilde{\beta}_1&=\frac{53}{140}\theta+(1-\theta)\frac{\omega_1+5\omega_2}{6},\\
\nonumber&\tilde{\beta}_2&=\frac{1}{105}\theta.
\end{eqnarray}
$\omega_k$是WENO-Z权函数，$\theta$由\eqref{chapter3eq:11}得到。

为了分析新混合格式的精度，我们将\eqref{chapter3eq:18}写为：
\begin{equation}\label{chapter3eq:19}
(1-\theta)C_{CRWENO5}+\theta C_7
\end{equation}
或者,
\begin{equation}\label{chapter3eq:20}
(1-\theta)C_5+(1-\theta)\sum_{k}(\omega_k-c_k)C_3^k+\theta C_7
\end{equation}
很明显，对于非光滑模板，由于$\theta \rightarrow 0$，混合格式趋于CRWENO格式。

对于光滑模板，我们有$\theta \rightarrow 1$，因此HCCS趋于七阶紧致格式。注意到, 对于$n$阶紧致格式
$$
C_{n,L}(...,\hat{f}_{i-1/2},\hat{f}_{i+1/2},\hat{f}_{i+3/2},...)=C_{n,R}(...,f_{i-1},f_{i},f_{i+1},...)
$$
其表达式右端是对左端的$n$阶近似：
$$
C_{n,L}-C_{n,R}=O(\Delta x^n).
$$
\eqref{chapter3eq:20}可以被写为:
\begin{eqnarray}\label{chapter3eq:21}
\nonumber C_{HCCS,L}-C_{HCCS,R}&=&(1-\theta)O_5(\Delta x^5)+(1-\theta)\sum_{k=0}^2(\omega_k-c_k)O^k_{3}(\Delta x^3) \\
&&+\theta O_7(\Delta x^7)
\end{eqnarray}
如果等式\eqref{chapter3eq:21}右端项的首项是七阶, 那么HCCS在光滑模板上就七阶精度的。因此，HCCS为七阶精度的充分条件是：
\begin{equation}
\begin{cases}
1-\theta=O(\Delta x^2), \\
(1-\theta)(\omega_k-c_k)=O(\Delta x^4)
\end{cases}
\end{equation}
因此, 考虑到$1-\theta=O(\Delta x^p)$\eqref{chapter3eq:16}和$\omega_k-c_k=O(\Delta x^s)$, 充分条件为：
\begin{equation}
\begin{cases}
p \ge 2, \\
p+s\ge 4
\end{cases}
\end{equation}
从而，如果 在计算\eqref{chapter1eq:20}中$\alpha_k$时， $q$取2, 则HCCS在光滑模板上就是七阶精度收敛的，即使在$s=1$的关键点处。

值得指出的是，以上分析具有一般性。因此可以用$\theta$的一般形式将WENO格式和其它线性格式组合起来构造新的混合格式。

\section{数值实验}\label{sec5}
在这一节中，我们将对HCCS进行广泛的数值测试，包括一维标量问题、一维欧拉问题、二维欧拉和二维N-S问题，并与五阶WENO-Z格式、五阶CRWENO格式和七阶WENO格式的计算结果进行了比较。由于2.4节的数值算例能很好的检验一个格式的性能，因此，如没有特别是的说明，计算的条件请参看2.4节中的详细说明。

三阶TVD Runge-Kutta方法\cite{shu1988total}被用作时间推进:
\begin{align}
&u^{(1)}=u^n+\Delta tL(u^n)\label{chapter3eq:34}\\
&u^{(2)}=\frac{3}{4}u^n+\frac{1}{4}u^{(1)}+\frac{1}{4}\Delta tL(u^{(1)})\label{chapter3eq:35}\\
&u^{n+1}=\frac{1}{3}u^n+\frac{2}{3}u^{(2)}+\frac{2}{3}\Delta tL(u^{(2)})\label{chapter3eq:36}.
\end{align}

对于存在强间断的一维欧拉问题，我们采用特征变量重构方式\cite{ghosh2012compact,ren2003characteristic}。对于二维问题，我们采用Steger―Warming格式\cite{steger1981flux}进行流通量分裂。考虑到$\varepsilon$的值对于数值结果有着一定影响\cite{Shen:2014gf}，对于一维线性方法$\varepsilon$被设置为$1\times 10^{-40}$，对于其他例子取值为$1\times 10^{-6}$。
\subsection{线性输运方程}\label{sec:linear}
对于线性输运方程：
\begin{align}\label{chapter3eq:37}
\begin{cases}
u_t+u_x=0,& -1\leqslant x\leqslant1\\
u(x,0)=u_0(x),& \text{periodic boundary},
\end{cases}
\end{align}
我们考虑两个初始条件。

第一个算例的初始条件为:
\begin{align}\label{chapter3eq:38}
u_0(x)=\text{sin}(\pi x-\frac{\text{sin} \pi x}{\pi}).
\end{align}
这个初始条件包含两个关键点，在这两个点上有$f'=0$且$f'''\neq 0$ \cite{henrick2005mapped}。时间步长$\Delta t$被设为$\Delta x^{n/3}$ 其中$n$是所测试格式的阶数。

\begin{table}[!htbp]
   \caption{不同格式对于线性输运方程初始条件\eqref{chapter3eq:38}的解在t=2时的$L_2$误差和收敛阶数}\label{tab:convergence1}
  \begin{center}\footnotesize
  \begin{tabular}{ccccccccc}
  \toprule
  \multirow{2}{*}{N} &
  \multicolumn{2}{c}{WENO-Z} &
  \multicolumn{2}{c}{CRWENO} &
  \multicolumn{2}{c}{WENO-7} &
  \multicolumn{2}{c}{HCCS} \\
  & $L_2$ & order & $L_2$ & order & $L_2$ & order & $L_2$ & order\\
  \midrule
  20  & 3.92E-03 & -  	& 1.88E-03 & -     & 6.05E-04 & -    & 1.09E-03 & -    \\
  40  & 1.38E-04 & 4.83 & 3.14E-05 & 5.90  & 5.10E-06 & 6.89 & 1.85E-06 & 9.23 \\
  80  & 4.39E-06 & 4.97 & 7.20E-07 & 5.48  & 4.16E-08 & 6.94 & 8.68E-09 & 7.76 \\
  160 & 1.37E-07 & 5.00 & 2.47E-08 & 4.86  & 3.29E-10 & 6.98 & 8.92E-11 & 6.62 \\
  320 & 4.28E-09 & 5.00 & 8.40E-10 & 4.88  & 2.58E-12 & 7.00 & 7.97E-13 & 6.83 \\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}

由于紧致格式的表达形式是隐式的，要计算边界处的数值通量需要给出边界格式。在第一个算例中测试了两种不同的边界格式。表\ref{tab:convergence1}给出了不同格式的误差和收敛阶数，其中HCCS格式的边界格式为七阶WENO格式。可以看出的是，HCCS的收敛阶数为接近七阶，且其误差要小于七阶WENO格式。

\begin{table}[!htbp]
  \caption{采用六阶和八阶中心格式作为边界格式时，HCCS的误差$L_2$和精度}\label{tab:convergence2}
  \begin{center}\footnotesize
  \begin{tabular}{ccccc}
  \toprule
  \multirow{3}{*}{N} &
  \multicolumn{2}{c}{Sixth order} &
  \multicolumn{2}{c}{Eighth order}\\
  & $L_2$ & order & $L_2$ & order \\
  \midrule
    20  & 1.05E-03 & -    & 1.06E-03 & -    \\
    40  & 7.38E-06 & 7.15 & 1.68E-06 & 9.32 \\
    80  & 1.75E-07 & 5.41 & 3.92E-09 & 8.74 \\
    160 & 3.63E-09 & 5.61 & 2.76E-11 & 7.15 \\
    320 & 6.46E-11 & 5.83 & 1.96E-13 & 7.14 \\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}

表\ref{tab:convergence2}比较了HCCS采用不同边界格式时的误差和收敛阶数，被测试的边界格式为六阶中心格式和八阶中心格式。可以看出，当采用六阶中心格式作为边界格式时，HCCS的收敛阶数为六阶；当采用八阶中心格式作为边界格式时，HCCS的收敛阶数达到七阶，并且它的误差要小于采用七阶WENO 格式作为边界格式时的误差。因此，对于本文中的其它算例，我们都采用八阶中心格式作为边界格式。

\begin{table}[!htbp]
   \caption{HCCS在不同$z$取值时的精度}\label{tab:z}
  \begin{center}\footnotesize
  \begin{tabular}{ccccccccc}
  \toprule
  \multirow{2}{*}{N} &
  \multicolumn{2}{c}{$z=1$} &
  \multicolumn{2}{c}{$z=2$} &
  \multicolumn{2}{c}{$z=3$} &
  \multicolumn{2}{c}{$z=4$} \\
  & $L_2$ & order & $L_2$ & order & $L_2$ & order & $L_2$ & order \\
  \midrule
  20  & 9.79E-04 & -  	& 1.06E-03 & -     & 1.15E-03 & -    & 1.23E-03 & -    \\
  40  & 5.26E-06 & 7.56 & 1.68E-06 & 9.32  & 6.49E-07 & 10.83 & 4.70E-07 & 14.72 \\
  80  & 2.47E-08 & 7.76 & 3.92E-09 & 8.74  & 3.61E-09 & 7.52 & 3.61E-09 & 7.02 \\
  160 & 2.91E-10 & 6.43 & 2.76E-11 & 7.15  & 2.72E-11 & 7.05 & 2.72E-11 & 7.05 \\
  320 & 3.14E-12 & 6.56 & 1.96E-13 & 7.14  & 1.95E-13 & 7.12 & 1.95E-13 & 7.12 \\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}

公式\eqref{chapter3eq:17}中参数$z$对HCCS的影响也被研究。表\ref{tab:z}中给出的数据表明，当$z=1$ 时, 误差几乎比其他取值大一个数量级。对于$z=2,3,4$, 其差距主要在稀疏网格上。在本文计算中，如无特别说明，我们采用$z=2$。

\begin{table}[!htbp]
   \caption{不同格式每个时间步长的平均计算时间（单位：秒） }\label{tab:time}
  \begin{center}\footnotesize
  \begin{tabular}{ccccc}
  \toprule
  N & WENO-Z & CRWENO & WENO-7 & HCCS \\
  \midrule
   20 & 3.36E-04 & 3.83E-04 & 5.21E-04 & 4.34E-04 \\
   40 & 5.15E-04 & 6.60E-04 & 9.45E-04 & 7.38E-04 \\
   80 & 1.09E-03 & 1.30E-03 & 1.86E-03 & 1.48E-03 \\
  160 & 2.09E-03 & 2.58E-03 & 3.73E-03 & 2.91E-03 \\
  320 & 4.22E-03 & 5.10E-03 & 7.27E-03 & 5.71E-03 \\
  640 & 8.41E-03 & 1.02E-02 & 1.40E-02 & 1.13E-02 \\
  \bottomrule
  \end{tabular}
  \end{center}
\end{table}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.8\textwidth]{pic/efficiency.jpg}
\caption{CPU time versus Error}
\label{chapter3fig:efficiency}
\end{center}
\end{figure}

表\ref{tab:time}给出了不同格式单步计算所需要的CPU时间。$HCCS$大约比七阶$WENO$格式快$20\%$。图\ref{chapter3fig:efficiency}画出了误差随CPU时间的分布。可以看出，在同样的误差的情况下，HCCS需要最少的计算时间，因此其效率是最高的。

第二个算例的初始条件与\eqref{composedwave}相同。
\begin{figure}[!htbp]
    \begin{center}
    \subfigure[高斯波]{
    \includegraphics[width=0.6\textwidth]{pic/1d/fig1.eps}}\label{fig1:a}
    \subfigure[方波]{
    \includegraphics[width=0.6\textwidth]{pic/1d/fig2.eps}}\label{fig1:b}
	\end{center}
\end{figure}

\begin{figure}[!htbp]
    \begin{center}
    \subfigure[三角波]{
    \includegraphics[width=0.6\textwidth]{pic/1d/fig3.eps}}\label{fig1:c}
    \subfigure[椭圆波]{
    \includegraphics[width=0.6\textwidth]{pic/1d/fig4.eps}}\label{fig1:d}
    \caption{线性对流方程初始条件\eqref{composedwave}在t=6时的解, N=200}
    \label{chapter3fig:linear}
    \end{center}
\end{figure}
图\ref{chapter3fig:linear}中展示了不同格式在 t=6时的解。可以看出来WENO-7对间断的分辨能力要好于其它格式，但HCCS获得了对于高斯波、三角波和椭圆波最准确的结果。还可以看出的是，HCCS在间断附近的分辨率要好于CRWENO格式。

\subsection{一维欧拉方程}
对于一维欧拉方程\eqref{chapter2eq:euler1d}，我们考察了四个带有强间断的典型算例：Sod问题、Lax问题、Shu-Osher问题以及冲击波碰撞问题。其中冲击波碰撞问题的初始条件为:
\begin{flalign}
\nonumber &(\rho,u,p)=
\begin{cases}
(1,0,1000)& 0\leqslant x<0.1\\
(1,0,0.01)& 0\leqslant x<0.9\\
(1,0,100)& 0.9\leqslant x\leqslant 1.
\end{cases}&
\end{flalign}
边界处采用反射边界条件。

\begin{figure}[!htbp]
    \begin{center}
    \subfigure[Sod问题，t=0.14]{
    \includegraphics[width=0.6\textwidth]{pic/1dEuler/sod.eps}}\label{chapter3fig:sod}
    \subfigure[Lax问题，t=0.13]{
    \includegraphics[width=0.6\textwidth]{pic/1dEuler/lax.eps}}\label{chapter3fig:lax}
	\label{chapter3fig:1dEuler1}
	\end{center}
\end{figure}

\begin{figure}[!htbp]
    \begin{center}
    \subfigure[Shu-Osher问题，t=1.8]{
    \includegraphics[width=0.6\textwidth]{pic/1dEuler/shuosher.eps}}\label{chapter3fig:shuosher}
    \subfigure[碰撞波问题，t=0.038]{
    \includegraphics[width=0.6\textwidth]{pic/1dEuler/blast.eps}}\label{chapter3fig:blast}
    \caption{一维欧拉方程不同问题解的密度分布}
    \label{chapter3fig:1dEuler}
    \end{center}
\end{figure}

所有的算例中网格点数取$N=200$。参考解由CRWENO格式在2000个点的网格上计算获得。图\ref{chapter3fig:1dEuler}绘出了各个算例的结果。HCCS表现出了对间断和光滑解很好的分辨能力，特别是对于有着小尺度波的Shu-Osher问题。

\subsection{二维欧拉方程}
在这一部分中考虑二维理想气体欧拉方程\eqref{chapter2eq:euler2d}问题，对HCCS、 七阶WENO格式、五阶WENO-Z格式和CRWENO格式测试了两个算例：等熵涡对流和双马赫反射。

\subsubsection{等熵涡对流}
本算例的计算条件和网格设置与\ref{chapter2sec:ivc}节中一致，时间积分到t=2000。
\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{pic/2dEuler/ivc/ivc-k.jpg}
\caption{动能在计算域上的积分随时间的变化}
\label{chapter3fig:kinetic energy}
\end{center}
\end{figure}

\begin{figure}[!htbp]
\begin{center}
\includegraphics[width=0.6\textwidth]{pic/2dEuler/ivc/ivc-p.eps}
\caption{t=2000时，不同格式在y=5处的压力分布}
\label{chapter3fig:pressure}
\end{center}
\end{figure}
图\ref{chapter3fig:kinetic energy} 展示了动能在计算域上积分随时间的演化。由于欧拉方程是无耗散的，动能的损失是由数值格式所带来的。从图中可以看出，HCCS基本上没有动能损失，说明HCCS的数值耗散极低。图\ref{chapter3fig:pressure}展示了不同格式$t=2000$时在y=5处的压力分布。HCCS给出的压力分布与初始值几乎一样，而其他的格式都有明显的误差。
\subsubsection{双马赫反射}
双马赫反射问题的计算条件与前文中的设置相同。
\begin{figure}[!htbp]
    \begin{center}
    \subfigure[WENO-Z]{
    \includegraphics[width=0.7\textwidth]{pic/2dEuler/dmr/dmr_weno5.eps}}\label{figdmr:a}
    \subfigure[CRWENO]{
    \includegraphics[width=0.7\textwidth]{pic/2dEuler/dmr/dmr_crweno.eps}}\label{figdmr:b}
    \subfigure[WENO7]{
    \includegraphics[width=0.7\textwidth]{pic/2dEuler/dmr/dmr_weno7.eps}}\label{figdmr:c}
    \subfigure[HCCS]{
    \includegraphics[width=0.7\textwidth]{pic/2dEuler/dmr/dmr_hccs.eps}}\label{figdmr:d}
    \caption{双马赫反射问题在t=0.2时刻解的密度等值线}
    \label{chapter3fig:dmr}
    \end{center}
\end{figure}

\begin{figure}[!htbp]
    \begin{center}
    \subfigure[WENO-Z]{
    \includegraphics[width=0.45\textwidth]{pic/2dEuler/dmr/dmr_weno5mg.eps}}\label{figdmrmg:a}
    \subfigure[CRWENO]{
    \includegraphics[width=0.45\textwidth]{pic/2dEuler/dmr/dmr_crwenomg.eps}}\label{figdmrmg:b}
    \subfigure[WENO7]{
    \includegraphics[width=0.45\textwidth]{pic/2dEuler/dmr/dmr_weno7mg.eps}}\label{figdmrmg:c}
    \subfigure[HCCS]{
    \includegraphics[width=0.45\textwidth]{pic/2dEuler/dmr/dmr_hccsmg.eps}}\label{figdmrmg:d}
    \caption{t=0.2时刻上卷区域的密度分布云图}
    \label{chapter3fig:dmrmg}
    \end{center}
\end{figure}
图\ref{chapter3fig:dmr}展示了不同格式所获得解的密度等值线分布。可以看出所有格式都很好的捕捉到了激波。图\ref{chapter3fig:dmrmg}展示了上卷区域的放大密度云图，可以看出两种紧致格式：CRWNEO格式和HCCS获得了比WENO-Z和WENO7更为丰富的Kelvin-Helmholtz不稳定小尺度结构，并且HCCS对小尺度结构的分辨率要好于CRWENO格式。


\subsection{二维Navier-Stokes方程}
理想气体的二维Navier-Stokes方程由\eqref{chapter2eq:ns2d}给出，粘性项由四阶中心格式离散\cite{shen2009high}。激波/剪切层相互作用算例的计算条件与前文中一致。

在$t=120$时刻的解被展示在图\ref{chapter3fig:ssl}中。所有的格式都能很好的捕捉激波。然而就涡结构而言，特别是对于下游区域的涡结构，HCCS相比于其它格式获得了更好的结果。
\begin{figure}[!htbp]
    \begin{center}
    \subfigure[WENO-Z]{
    \includegraphics[width=0.9\textwidth]{pic/2dNS/ssl/ssl_weno5.eps}}\label{figssl:a}
    \subfigure[CRWENO]{
    \includegraphics[width=0.9\textwidth]{pic/2dNS/ssl/ssl_crweno.eps}}\label{figssl:b}
    \subfigure[WENO7]{
    \includegraphics[width=0.9\textwidth]{pic/2dNS/ssl/ssl_weno7.eps}}\label{figssl:c}
    \subfigure[Present]{
    \includegraphics[width=0.9\textwidth]{pic/2dNS/ssl/ssl_hccs.eps}}\label{figssl:d}
    \subfigure[Reference]{
    \includegraphics[width=0.9\textwidth]{pic/2dNS/ssl/ssl_ref.eps}}\label{figssl:e}
    \caption{激波/剪切层相互作用问题在t=120时刻解的密度分布云图}
    \label{chapter3fig:ssl}
    \end{center}
\end{figure}

\section{本章小结}\label{sec6}
在这一章中，针对CRWENO格式在激波附近精度降低的问题, 我们提出了一种多步加权方法。精度分析表明，CRWENO格式在间断附近的精度为二阶。通过引入多步加权方法，新格式在激波附近点的精度能够提升到三阶。 数值计算结果表明，所提出的多步加权CRWENO格式在光滑和间断区域都有着更高的精度和更低的耗散。对于长时间模拟如湍流的大涡模拟和直接数值模拟来说，我们所提出的方法能够提供更精确的结果。多步加权方法是一种能够有效提高格式激波分辨率的方法。它也可以被应用到有着同样问题的其他加权紧致格式上去。

为了更精确地模拟流场，发展流场自适应的高精度激波捕捉算法。本章中提出了一种不含问题相关参数的混合格式加权开关函数。这个开关函数在光滑区域是1的高阶近似，而在间断附近快速趋向于0。通过使用这一开关函数，我们可以构造出一类具有一致精度的低耗散混合激波捕捉格式。基于所提出的方法，我们在5点模板上构造了七阶紧致-CRWENO格式。数学分析和数值计算表明，所提出的新格式在光滑区域达到七阶精度并且有着很好的激波捕捉能力，其效率和耗散性要好于七阶WENO格式。

我们所提出的开关函数还可用于发展其他的高阶混合方法，相比于文献中的开关函数，本方法不需要任何与问题相关的参数，因此基于该函数所发展的混合格式更为鲁棒可被用于广泛的可压缩流动计算中。

值得注意的是，与原格式相比，本文的多步加权方法需要计算额外的三个权重。这导致了将近50\%的计算量增加。然而，对于实际的超声速湍流数值计算来说，全局的多步加权是不必要的。为了降低计算量，可以利用所构造的开关函数进行二次混合格式构造，只在间断附近使用多步加权方法。注意到，所提出的开关函数存在一个不动点，对于任何z，$x=2$时$\theta=0.5$。利用这一特点，我们可以在代码中加入判断语句，当$\theta$小于0.5时开启多步加权的方法。这样在光滑区域使用的是HCCS，在梯度较大的区域HCCS趋近于CRWENO 格式，而在梯度非常大的地方，HCCS趋近于多步加权CRWENO格式。通过这种方式能够极大的提高计算精度和计算效率。这一部分工作的深入研究正在开展中。
